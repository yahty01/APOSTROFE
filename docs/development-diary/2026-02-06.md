# Дневник разработки — 2026-02-06

Сделано (public + admin, “registry / brut” стиль)

Дизайн‑токены + примитивы (.ui-frame/.ui-panel/.ui-tab/.ui-btn-*, квадраты, 1px линии, моно‑поля): globals.css (line 1)
Общий каркас + хедеры/контролы/футер: AppShell.tsx (line 1), TopHeader.tsx (line 1), AdminHeader.tsx (line 1), ViewSwitcher.tsx (line 1), Footer.tsx (line 1)
Ticker из settings_marquee + fallback “WE LICENSE IDENTITY” при пустом тексте: Marquee.tsx (line 1)
Public /models: hero, cards/list, карточки‑“паспорт” + [ ACQUIRE LICENSE ], таблица 5 колонок, CTA [ ЗАПРОСИТЬ ЛИЦЕНЗИЮ ]: page.tsx (line 1), AssetCards.tsx (line 1), AssetsTable.tsx (line 1)
Detail /models/[document_id] 50/50 + thumbnails + spec‑панель + 2 CTA: page.tsx (line 1)
Заглушки табов: page.tsx (line 1), page.tsx (line 1), page.tsx (line 1)
Admin рескин без смены логики (login/models/edit/media/marquee): page.tsx (line 1), layout.tsx (line 1), page.tsx (line 1), page.tsx (line 1)
Telegram + i18n

Хелпер share‑URL + “паспортный” текст: telegram.ts (line 1) (подключён в public CTA/кнопках)
Ключи public.catalogTitle/catalogSubtitle/cta.requestLicense/comingSoon: ru.json (line 1), en.json (line 1)
Проверка

pnpm lint (1 warning: react-hooks/incompatible-library из‑за @tanstack/react-virtual), pnpm build проходит
Playwright smoke + скриншоты:
list /models: page-2026-02-06T00-31-10-379Z.png
cards /models: page-2026-02-06T00-31-41-811Z.png
detail /models/...: page-2026-02-06T00-32-06-411Z.png
/admin/login: page-2026-02-06T00-32-44-248Z.png
Важно про Roboto Condensed

next/font/google для Roboto_Condensed ломал pnpm build без доступа к fonts.googleapis.com, поэтому убрал его и сделал “condensed” через font-variation-settings в .font-condensed: globals.css (line 1). Если нужен именно Roboto Condensed — переключу на next/font/local, но нужны .woff2 файлы.
Команды: pnpm dev или pnpm build && pnpm start.

## Цель дня

Перерисовать весь сайт (public + admin) в бруталистичном монохромном “реестровом” стиле по ТЗ: жёсткая сетка, тонкие 1px линии, без теней/градиентов/скруглений, condensed uppercase заголовки + моноширинные системные поля. Сохранить текущую логику (Supabase, фильтры/пагинация, marquee из `settings_marquee`, view switch). Все CTA ведут в Telegram share с prefill-текстом (id + метаданные).

## Сделано (итог)

- Ввёл дизайн-токены и набор общих UI-примитивов (рамки/панели/кнопки/табы/инпуты) под “registry” стиль: `src/app/globals.css`.
- Добавил общий AppShell-каркас (header → ticker → main → footer) для public/admin: `src/components/shell/AppShell.tsx`.
- Собрал новый public header:
  - бренд APOSTROPHE + 4 таба (MODELS’/CREATORS’/GENERATORS’/INFLUENCERS’) с active-инверсией;
  - LanguageDropdown (RU/EN) сохраняет текущий path + query;
  - ViewSwitcher (VIEW: CARDS/LIST + SWITCH) сохраняет `view` в URL и `sessionStorage(models_view)`;
  - SystemStatus фиксировано показывает “СИСТЕМА: В СЕТИ / АКТИВЫ: 1420”.
  - Файлы: `src/components/shell/TopHeader.tsx`, `src/components/shell/LanguageDropdown.tsx`, `src/components/shell/ViewSwitcher.tsx`, `src/components/shell/SystemStatus.tsx`.
- Собрал admin header в том же стиле (MODELS’/MARQUEE’/PUBLIC’ + SIGN OUT): `src/components/shell/AdminHeader.tsx`.
- TickerStrip:
  - источник — `settings_marquee` (Supabase);
  - fallback “WE LICENSE IDENTITY” если `enabled=true`, но текст пустой;
  - файл: `src/components/Marquee.tsx`.
- Footer двухуровневый по ТЗ (3 колонки + bottom meta-bar): `src/components/shell/Footer.tsx`.

## Public: /models (cards/list) + CTA

- Страница `/models`:
  - Hero: “КАТАЛОГ АКТИВОВ” + подзаголовок “РЕЕСТР ЛИЦЕНЗИРОВАННЫХ ЦИФРОВЫХ ИДЕНТИЧНОСТЕЙ.”;
  - сервис-панель (count/page + фильтр category) в сетке с линиями;
  - контент в cards/list (по `view`);
  - CTA `[ ЗАПРОСИТЬ ЛИЦЕНЗИЮ ]` ведёт в Telegram share;
  - файл: `src/app/(public)/models/page.tsx`.
- Cards view:
  - 5 колонок на wide desktop (жёсткая матрица);
  - карточка: portrait + meta “паспорт” (DOCUMENT_ID/TIMESTAMP/LICENSE/STATUS/DESCRIPTION) с разделителями + `[ ACQUIRE LICENSE ]`;
  - hover: инверсия meta-области (black/white);
  - файл: `src/components/models/AssetCards.tsx`.
- List view:
  - таблица 5 колонок (DOCUMENT_ID/TIMESTAMP/LICENSE_TYPE/STATUS/DESCRIPTION);
  - header: чёрный фон, белый текст;
  - строка: click → selected (инверсия);
  - документ id ведёт на `/models/[document_id]`;
  - файл: `src/components/models/AssetsTable.tsx`.
- Добавил `description` в тип и запрос списка, чтобы заполнять DESCRIPTION: `src/components/models/types.ts`, `src/app/(public)/models/page.tsx`.

## Public: detail /models/[document_id]

- Лэйаут 50/50: слева большой портрет + 4 thumbnails, справа spec-панель с секциями и горизонтальными линиями.
- Метаданные строкой: `{STATUS} · {LICENSE} · {YYYY-MM-DD}`.
- Кнопки: `[ ACQUIRE LICENSE ]` (primary) + `[ REQUEST INFO ]` (outline), обе ведут в Telegram share.
- Файл: `src/app/(public)/models/[document_id]/page.tsx`.

## Public: заглушки под табы (чтобы не было 404)

- `/creators`, `/generators`, `/influencers` — минимальные страницы “COMING SOON” в том же визуале:
  - `src/app/(public)/creators/page.tsx`
  - `src/app/(public)/generators/page.tsx`
  - `src/app/(public)/influencers/page.tsx`

## Admin: рескин без изменения логики

- Обновил стили login + protected layout + models list + edit/new + media manager + marquee settings под общий registry-стиль:
  - `src/app/(admin)/admin/login/page.tsx`
  - `src/app/(admin)/admin/(protected)/layout.tsx`
  - `src/app/(admin)/admin/(protected)/models/page.tsx`
  - `src/app/(admin)/admin/(protected)/models/[id]/page.tsx`
  - `src/app/(admin)/admin/(protected)/models/new/NewModelClient.tsx`
  - `src/app/(admin)/admin/(protected)/models/AssetForm.tsx`
  - `src/app/(admin)/admin/(protected)/models/MediaManager.tsx`
  - `src/app/(admin)/admin/(protected)/settings/marquee/page.tsx`
  - `src/app/(admin)/admin/(protected)/settings/marquee/MarqueeForm.tsx`

## Telegram CTA helper

- Вынес генерацию share-url и prefill-текстов в `src/lib/telegram.ts`:
  - `buildTelegramShareUrl(text, url?)`
  - `buildLicenseRequestText(assetLike)`
  - `buildRequestInfoText(assetLike)`
  - `buildGenericLicenseRequestText()`
- Подключил helper в cards/detail/catalog CTA.

## i18n

- Обновил public ключи:
  - `public.catalogTitle` (RU: “КАТАЛОГ АКТИВОВ”, EN: “ASSET CATALOG”)
  - `public.catalogSubtitle`
  - `public.cta.requestLicense`
  - `public.comingSoon`
  - Файлы: `src/messages/ru.json`, `src/messages/en.json`.

## Проверки / валидация

- `pnpm lint`: без ошибок, 1 warning `react-hooks/incompatible-library` из-за `@tanstack/react-virtual` в таблице (не блокирует сборку).
- `pnpm build`: успешно.
- Playwright smoke (локально через `next start`):
  - `/models` (cards/list), `/models/[document_id]`, `/creators`, `/admin/login` — рендерятся, переключатель view работает, CTA ведут в `t.me/share/url`.
  - Скриншоты сохранены в temp: `/var/folders/.../T/playwright-mcp-output/...` (см. историю запуска Codex).

## Замечания / ограничения

- `next/font/google` для Roboto Condensed ломает `pnpm build` без доступа к `fonts.googleapis.com` (сетевое ограничение окружения).
  - Поэтому оставил “condensed” через CSS (`font-variation-settings`) на текущем sans. При необходимости подключим шрифт локально через `next/font/local` (нужны `.woff2` в репозитории).

