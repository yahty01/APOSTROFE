# 01. Обзор проекта

## 1) Что делает приложение
APOSTROFE — это реестр цифровых сущностей с публичной витриной и админкой:
- Витрина: список сущностей (`models/creators/influencers`), карточки и таблица, фильтрация, пагинация, детальные страницы.
- Админка: управление сущностями, публикацией и медиа, настройка бегущей строки (marquee).

## 2) Главные сущности домена
- `model`: тип модели, JSON-поля (`measurements`, `details`), медиа (`catalog`, `hero`, `gallery`).
- `creator`: направление (`creator_direction`), медиа.
- `influencer`: тематика, площадки, соц.ссылки, медиа.

Все три типа лежат в одной таблице `public.assets` и различаются по `entity_type`.

## 3) Бизнес-правила, которые важно не сломать
1. В публичной части видны только `is_published = true`.
2. Доступ к админским операциям только для `profiles.role in ('admin', 'editor')`.
3. Файлы в Storage читаются публично только если связанному ассету разрешён публичный доступ (через policy).
4. `document_id` генерируется сервером при создании и используется:
- в URL публичной детали,
- как корневая папка в bucket `assets`.

## 4) Ключевые пользовательские сценарии
### Публичный пользователь
1. Открывает `/models` (или `/creators`, `/influencers`).
2. Выбирает режим `cards/list`, фильтр, листает страницы.
3. Переходит в детальную страницу.
4. Отправляет заявку в Telegram через CTA.

### Админ
1. Логинится на `/admin/login`.
2. Создаёт/редактирует сущность.
3. Загружает `catalog/hero/gallery`.
4. Публикует.
5. Проверяет отображение на публичной странице.

## 5) Состояние разделов
- `models`: полностью рабочий поток.
- `creators`: рабочий поток создания/публикации/деталей.
- `influencers`: рабочий поток + соц.ссылки.
- `generators`: заглушка (`coming soon`).

## 6) Где это отражено в коде
- Универсальная публичная страница реестра: `src/components/models/PublicRegistryPage.tsx`
- Детальные страницы:
- `src/app/(public)/models/[document_id]/page.tsx`
- `src/app/(public)/creators/[document_id]/page.tsx`
- `src/app/(public)/influencers/[document_id]/page.tsx`
- Универсальные admin actions: `src/app/(admin)/admin/(protected)/models/*.ts`

## 7) Что считать MVP-границей
Сейчас нет полноценного набора автотестов; контроль качества делается через ручной smoke-чеклист.
Это допустимо для MVP, но при масштабировании нужно добавить e2e/интеграционные проверки на критический flow.

